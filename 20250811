/*

1.  Global Advisory Board 
2.  VIP individuals
2.  Executive Board for Asia 
3.  Young Alumni Board 
4.  Kellogg Alumni Council 
5.  Healthcare at Kellogg Advisory Council 
6.  Kellogg Asset Management Practicum Advisory Council 
7.  Kellogg Real Estate Advisory Council 
8.  Private Equity Advisory Council 
9.  Private Equity Advisory Council - Asia 
10. Technology Council 





  
need to create code when I pull each list and dedupe based on heiarchy

questions:
make sure to pull for both the GAB list and the Healthcare list is on VIP list
ask about GAB life members.... (only include gab members or life members as well?)


Notes: make sure that all VIP individuals are pulling from email tool
*/


with VIP as (
select donor_id as constituent_donor_id
      ,'Y' as VIP
from mv_entity
where donor_id in (
  '0000086400'
, '0000089435'
, '0000254448'
, '0000286815'
, '0000289544'
, '0000293464'
, '0000296095'
, '0000296095'
, '0000311491'
, '0000324229'
, '0000328033'
, '0000336894'
, '0000338604'
, '0000339334'
, '0000342449'
, '0000342515'
, '0000345649'
, '0000345651'
, '0000358270'
, '0000368381'
, '0000371305'
, '0000379180'
, '0000382788'
, '0000383158'
, '0000387701'
, '0000406102'
, '0000429958'
, '0000429958'
, '0000432865'
, '0000450440'
, '0000478895'
, '0000478896'
, '0000491738'
, '0000498723'
, '0000514317'
, '0000534427'
, '0000646184'
)
)


, Earnhardt_GAB_Healthcare as (
select donor_id as constituent_donor_id
      ,'Y' as Earnhardt_GAB_Healthcare
from mv_entity
where donor_id in (
'0000328657'
)
)

, GAB_Member as (
select constituent_donor_id
      ,'Y' as GAB_Member
from v_committee_gab
where involvement_role = 'Member'
)

, ebfa as (
select constituent_donor_id
      ,'Y' as ebfa
from v_committee_asia
)

, yab as (
select constituent_donor_id
      ,'Y' as yab
from v_committee_yab
)

, kac as (
select constituent_donor_id
      ,'Y' as kac
from v_committee_kac
)

, healthcare as (
select constituent_donor_id
      ,'Y' as healthcare
from v_committee_healthcare
)

, amp as (
select constituent_donor_id
      ,'Y' as amp
from v_committee_amp
)

, realestate as (
select constituent_donor_id
      ,'Y' as realestate
from v_committee_realestcouncil
)

, pevc as (
select constituent_donor_id
      ,'Y' as pevc
from v_committee_privateequity
)

, asia_pevc as (
select constituent_donor_id
      ,'Y' as asia_pevc
from v_committee_pe_asia
)

, tech as (
select constituent_donor_id
      ,'Y' as tech
from v_committee_tech
)


, all_segments as (
select constituent_donor_id from VIP
union
select constituent_donor_id from Earnhardt_GAB_Healthcare
union
select constituent_donor_id from GAB_Member
union
select constituent_donor_id from ebfa
union
select constituent_donor_id from yab
union
select constituent_donor_id from kac
union
select constituent_donor_id from healthcare
union
select constituent_donor_id from amp
union
select constituent_donor_id from realestate
union
select constituent_donor_id from pevc
union
select constituent_donor_id from asia_pevc
union
select constituent_donor_id from tech
)






select mv_entity.donor_id
      ,mv_entity.first_name
      ,mv_entity.last_name
      ,VIP
      ,Earnhardt_GAB_Healthcare.Earnhardt_GAB_Healthcare
      ,GAB_Member.GAB_Member
      ,ebfa.ebfa
      ,yab.yab
      ,kac.kac
      ,healthcare.healthcare
      ,amp.amp
      ,realestate.realestate
      ,pevc.pevc
      ,asia_pevc.asia_pevc
      ,tech.tech
      , case when VIP.VIP = 'Y' then 'VIP'
             when Earnhardt_GAB_Healthcare.Earnhardt_GAB_Healthcare = 'Y' then 'GAB and healthcare'
             when GAB_Member.GAB_Member = 'Y'  then 'GAB_Member'
             when ebfa.ebfa = 'Y' then 'ebfa'
             when yab.yab = 'Y' then 'yab'
             when kac.kac = 'Y' then 'kac'
             when healthcare.healthcare = 'Y' then 'healthcare'
             when amp.amp = 'Y' then 'amp'
             when realestate.realestate = 'Y' then 'realestate'
             when pevc.pevc = 'Y' then 'pevc'
             when asia_pevc.asia_pevc = 'Y' then 'asia_pevc'
             when tech.tech = 'Y' then 'tech' end as deduped_lists
      ,mv_entity_contact_info.email_preferred
      ,mv_special_handling.no_email_ind
      ,mv_special_handling.no_contact
from mv_entity
left join VIP on VIP.constituent_donor_id = mv_entity.donor_id 
left join Earnhardt_GAB_Healthcare on Earnhardt_GAB_Healthcare.constituent_donor_id = mv_entity.donor_id
left join GAB_Member on GAB_Member.constituent_donor_id = mv_entity.donor_id
left join ebfa on ebfa.constituent_donor_id = mv_entity.donor_id
left join yab on yab.constituent_donor_id = mv_entity.donor_id
left join kac on kac.constituent_donor_id = mv_entity.donor_id
left join healthcare on healthcare.constituent_donor_id = mv_entity.donor_id
left join amp on amp.constituent_donor_id = mv_entity.donor_id
left join realestate on realestate.constituent_donor_id = mv_entity.donor_id
left join pevc on pevc.constituent_donor_id = mv_entity.donor_id
left join asia_pevc on asia_pevc.constituent_donor_id = mv_entity.donor_id
left join tech on tech.constituent_donor_id = mv_entity.donor_id
left join mv_special_handling on mv_special_handling.donor_id = mv_entity.donor_id -- special handling codes (no email, no contact)
left join mv_entity_contact_info on mv_entity_contact_info.donor_id = mv_entity.donor_id -- preferred email
where VIP.VIP = 'Y'
      or Earnhardt_GAB_Healthcare.Earnhardt_GAB_Healthcare = 'Y' 
      or GAB_Member.GAB_Member = 'Y'
      or ebfa.ebfa = 'Y'
      or yab.yab = 'Y'
      or kac.kac = 'Y'
      or healthcare.healthcare = 'Y'
      or amp.amp = 'Y'
      or realestate.realestate = 'Y'
      or pevc.pevc = 'Y'
      or asia_pevc.asia_pevc = 'Y'
      or tech.tech = 'Y'

